"use strict";var _createClass=function(){function e(o,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(o,e.key,e)}}return function(o,n,i){return n&&e(o.prototype,n),i&&e(o,i),o}}();function _classCallCheck(o,n){if(!(o instanceof n))throw new TypeError("Cannot call a class as a function")}require(["../js/config.js"],function(){require(["jquery","template","cookie","comment","bootstrap"],function(s,n,o,i,e){new(function(){function o(){_classCallCheck(this,o),this.load()}return _createClass(o,[{key:"load",value:function(){var n=this;s.ajax({url:"../js/json/cjpl.json",success:function(o){n.data=o,n.display()}})}},{key:"display",value:function(){var i=this;if(this.goodinfo=s.cookie("goodsinfo"),this.goodinfo){this.goodinfo=JSON.parse(this.goodinfo),console.log(this.goodinfo);var t=[];this.data.forEach(function(e,o,n){i.goodinfo.forEach(function(o,n,i){e.id==o.goodsid&&t.push(e)})});var o=n("goodslist",{list:t,num:this.goodinfo});s(".cartlist_wrap").append(o),this.addEvent(),this.check(),this.remove()}else alert("您的购物车空空如也呢，快去选择心爱的宝贝吧！")}},{key:"addEvent",value:function(){var n=this;s(".sum_down").click(function(){var o=s(this).siblings("input").val();o++,n.addnum(s(this),o),n.jiesuan()}),s(".sum_add").click(function(){var o=s(this).siblings("input").val();--o<=1&&(o=1),n.addnum(s(this),o),n.jiesuan()}),this.allnum()}},{key:"addnum",value:function(o,n){var i=o.parents("ul").index(),e=o.parents("ul").find(".item_price"),t=o.parents("ul").find(".item_money");o.siblings("input").val(n),this.goodinfo[i].goodsnum=n,s.cookie("goodsinfo",JSON.stringify(this.goodinfo));JSON.parse(s.cookie("goodsinfo"));var a=n*e.text();t.text(a.toFixed(2)),this.allnum()}},{key:"allnum",value:function(){var i=0;s(".number-goods").each(function(o,n){i+=parseInt(s(n).val())}),s(".goodsum").text(i)}},{key:"check",value:function(){var o=this;s(".cartlist_wrap .checkbox em").click(function(){s(this).toggleClass("icon"),s(".cartlist_wrap .checkbox em").length==s(".cartlist_wrap .checkbox .icon").length?s(".pay_tools_bar .checkbox em").addClass("icon"):s(".pay_tools_bar .checkbox em").removeClass("icon"),o.jiesuan()}),s(".pay_tools_bar .checkbox em").click(function(){s(this).toggleClass("icon"),s(this).hasClass("icon")?(s(".cartlist_wrap .checkbox em").each(function(o,n){s(n).addClass("icon")}),s(".allremove").click(function(){confirm("确认全部删除！")&&(s.cookie("goodsinfo",null),s(location).attr("href","shoppingcart.html"))})):s(".cartlist_wrap .checkbox em").each(function(o,n){s(n).removeClass("icon")}),o.jiesuan()})}},{key:"jiesuan",value:function(){for(var o=0,n=0,i=s(".cartlist_wrap .icon"),e=0;e<i.length;e++)o+=parseInt(i.eq(e).parents("ul").find(".number-goods").val()),n+=parseInt(i.eq(e).parents("ul").find(".item_money").text());s(".goodsnum1").text(o),s(".pay-sum").text(n.toFixed(2))}},{key:"remove",value:function(){var n=this;s(".goodsremove").click(function(){var o=s(this).parents("ul").index();s(".cartlist_wrap ul").eq(o).remove();n.goodinfo.splice(o,1);s.cookie("goodsinfo",JSON.stringify(n.goodinfo))})}}]),o}())})});